<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>2048 Number Puzzle</title>

<style>
:root{
  --card-bg: rgba(255,255,255,0.85);
  --card-dark: rgba(30,30,30,0.85);
  --btn:#ff9f43;
  --btn2:#ff6b6b;
  --text:#2d3436;
}

/* Animated Background */
body{
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background:linear-gradient(-45deg,#6c5ce7,#00cec9,#fd79a8,#fab1a0);
  background-size:400% 400%;
  animation:bgMove 12s ease infinite;
  font-family:Arial,sans-serif;
  color:var(--text);
}
@keyframes bgMove{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}

body.dark{
  background:linear-gradient(-45deg,#0f2027,#203a43,#2c5364,#1c1c1c);
  background-size:400% 400%;
}

/* Common */
*{margin:0;padding:0;box-sizing:border-box}
.screen{
  display:none;
  width:100%;
  max-width:420px;
  padding:22px;
}
.active{display:block}

/* Glass Card */
.card{
  background:var(--card-bg);
  backdrop-filter:blur(12px);
  border-radius:20px;
  padding:20px;
  box-shadow:0 20px 40px rgba(0,0,0,0.2);
}
body.dark .card{
  background:var(--card-dark);
  color:#fff;
}

/* Headings */
h1,h2{text-align:center;margin-bottom:20px}

/* Buttons */
button{
  width:100%;
  padding:14px;
  margin:10px 0;
  border:none;
  border-radius:12px;
  font-size:16px;
  cursor:pointer;
  background:linear-gradient(135deg,var(--btn),var(--btn2));
  color:#fff;
  transition:transform .2s,box-shadow .2s;
}
button:active{transform:scale(.97)}
button:hover{box-shadow:0 10px 20px rgba(0,0,0,.25)}

/* Top Bar */
.topbar{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:12px;
}
.topbar button{
  width:auto;
  padding:8px 14px;
  font-size:14px;
}

/* Score Boxes */
.scores{display:flex;gap:10px}
.box{
  background:#2d3436;
  color:#fff;
  padding:8px 14px;
  border-radius:10px;
  font-size:14px;
  text-align:center;
}

/* Board */
.board{
  background:#bbada0;
  border-radius:16px;
  padding:10px;
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:10px;
  touch-action:none;
}
.cell{
  width:100%;
  padding-top:100%;
  background:#cdc1b4;
  border-radius:12px;
  position:relative;
}
.tile{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:26px;
  font-weight:bold;
  background:#eee4da;
  border-radius:12px;
  animation:pop .15s ease;
}
@keyframes pop{0%{transform:scale(.8)}100%{transform:scale(1)}}

/* Privacy Text */
.privacy{font-size:14px;line-height:1.6}

/* Responsive */
@media(max-width:360px){
  .tile{font-size:22px}
}
</style>
</head>

<body>

<!-- Splash -->
<div id="splash" class="screen active">
  <div class="card">
    <h1>2048 Puzzle</h1>
    <p style="text-align:center">Loading...</p>
  </div>
</div>

<!-- Menu -->
<div id="menu" class="screen">
  <div class="card">
    <h2>Main Menu</h2>
    <button onclick="startGame()">Start Game</button>
    <button onclick="openPrivacy()">Privacy Policy</button>
    <button onclick="toggleTheme()">Dark / Light</button>
  </div>
</div>

<!-- Game -->
<div id="game" class="screen">
  <div class="card">
    <div class="topbar">
      <button onclick="goMenu()">â¬… Back</button>
      <div class="scores">
        <div class="box">Score<br><span id="score">0</span></div>
        <div class="box">Best<br><span id="best">0</span></div>
      </div>
    </div>
    <div class="board" id="board"></div>
  </div>
</div>

<!-- Game Over -->
<div id="gameover" class="screen">
  <div class="card">
    <h2>Game Over</h2>
    <p>Your Score</p>
    <h1 id="finalScore">0</h1>
    <button onclick="restartGame()">Play Again</button>
    <button onclick="goMenu()">Main Menu</button>
  </div>
</div>

<!-- Privacy -->
<div id="privacy" class="screen">
  <div class="card">
    <h2>Privacy Policy</h2>
    <div class="privacy">
      <p>No personal data collected.</p>
      <p>No login required.</p>
       <p>Allow INTERNET Access</p>
      <p>Scores saved locally only.</p>
      <p>Applicable to Android app.</p>
    </div>
    <button onclick="goMenu()">Back</button>
  </div>
</div>

<script>
const screens={splash,menu,game,gameover,privacy};
function show(id){
  Object.values(screens).forEach(s=>s.classList.remove('active'));
  screens[id].classList.add('active');
}
setTimeout(()=>show('menu'),1400);

function startGame(){show('game');init()}
function goMenu(){show('menu')}
function openPrivacy(){show('privacy')}
function toggleTheme(){document.body.classList.toggle('dark')}

const board=document.getElementById('board');
const scoreEl=document.getElementById('score');
const bestEl=document.getElementById('best');
const finalScore=document.getElementById('finalScore');

let grid=[],score=0;
bestEl.textContent=localStorage.getItem('best')||0;

function init(){
  grid=Array(16).fill(0);
  score=0;
  scoreEl.textContent=0;
  addTile();addTile();render();
}

function addTile(){
  let e=grid.map((v,i)=>v===0?i:null).filter(v=>v!==null);
  if(!e.length)return;
  let i=e[Math.floor(Math.random()*e.length)];
  grid[i]=Math.random()>0.9?4:2;
}

function render(){
  board.innerHTML='';
  grid.forEach(v=>{
    const c=document.createElement('div');
    c.className='cell';
    if(v){
      const t=document.createElement('div');
      t.className='tile';
      t.textContent=v;
      c.appendChild(t);
    }
    board.appendChild(c);
  });
}

function move(dir){
  let old=[...grid];
  const slide=r=>{
    let a=r.filter(v=>v);
    for(let i=0;i<a.length-1;i++){
      if(a[i]==a[i+1]){
        a[i]*=2;score+=a[i];a[i+1]=0;
        if(navigator.vibrate)navigator.vibrate(30);
      }
    }
    a=a.filter(v=>v);
    while(a.length<4)a.push(0);
    return a;
  };
  for(let i=0;i<4;i++){
    let r;
    if(dir=='left')r=slide(grid.slice(i*4,i*4+4));
    if(dir=='right')r=slide(grid.slice(i*4,i*4+4).reverse()).reverse();
    if(dir=='up')r=slide([grid[i],grid[i+4],grid[i+8],grid[i+12]]);
    if(dir=='down')r=slide([grid[i],grid[i+4],grid[i+8],grid[i+12]].reverse()).reverse();
    for(let j=0;j<4;j++){
      let idx=(dir=='up'||dir=='down')?i+j*4:i*4+j;
      grid[idx]=r[j];
    }
  }
  if(JSON.stringify(old)!==JSON.stringify(grid)){
    addTile();render();
    scoreEl.textContent=score;
    if(score>bestEl.textContent){
      bestEl.textContent=score;
      localStorage.setItem('best',score);
    }
    if(isGameOver()){
      finalScore.textContent=score;
      show('gameover');
    }
  }
}

function isGameOver(){
  if(grid.includes(0))return false;
  for(let i=0;i<16;i++){
    if(i%4<3 && grid[i]==grid[i+1])return false;
    if(i<12 && grid[i]==grid[i+4])return false;
  }
  return true;
}

function restartGame(){show('game');init()}

let sx,sy;
board.addEventListener('touchstart',e=>{
  sx=e.touches[0].clientX;sy=e.touches[0].clientY;
});
board.addEventListener('touchend',e=>{
  let dx=e.changedTouches[0].clientX-sx;
  let dy=e.changedTouches[0].clientY-sy;
  Math.abs(dx)>Math.abs(dy)?move(dx>0?'right':'left'):move(dy>0?'down':'up');
});
window.addEventListener('keydown',e=>{
  if(e.key.includes('Arrow'))move(e.key.replace('Arrow','').toLowerCase());
});
</script>

</body>
</html>
